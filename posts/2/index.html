
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>El SysAdmin del 3er Mundo</title>
  <meta name="author" content="låzaro">

  
  <meta name="description" content="LEMP en Centos 7 24/07/2017 12:33 am | Comments En la entrada anterior, vimos como instalar un LEMP (nginx, mysql y php) en
debian. Debian que en mi &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://uranio-235.github.io/posts/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="El SysAdmin del 3er Mundo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">El SysAdmin del 3er Mundo</a></h1>
  
    <h2>todo lo que expliqué mientras nadie prestaba atención</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.google.com" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="uranio-235.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/archives">Archivo</a></li>
  <li><a href="/blog/categories/rails/">Ruby on Rails</a></li>
  <li><a href="/blog/categories/islam/">Islam</a></li>
  <li><a href="/blog/categories/destacado/">Destacado</a></li>
  <li><a href="/blog/categories/razonemos/">Razonemos</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/07/24/lemp-en-centos/">LEMP en Centos 7</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-07-24T00:33:51-04:00'><span class='date'>24/07/2017</span> <span class='time'>12:33 am</span></time>
        
           | <a href="/blog/2017/07/24/lemp-en-centos/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/07/24/lemp-en-centos/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>En la entrada anterior, vimos como instalar un LEMP (nginx, mysql y php) en
debian. Debian que en mi opinión ya pasó su carnaval y RHEL sigue campeando.</p>

<p>En centos necesitaremos el repo EPEL</p>

<figure class='code'><figcaption><span>&#8220;instalando epel&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum install epel-release</span>
</span><span class='line'><span class="go"> yum makecache fast</span>
</span></code></pre></td></tr></table></div></figure>


<p>Una vez que tenemos acoplado el EPEL, alamos nginx y le decimos a systemd que
arranque nginx junto con el sistema.</p>

<figure class='code'><figcaption><span>&#8220;instalando nginx&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum install nginx</span>
</span><span class='line'><span class="go"> systemctl enable nginx</span>
</span><span class='line'><span class="go"> systemctl start nginx</span>
</span></code></pre></td></tr></table></div></figure>


<p>Matao el gallo con nginx. Vamos para mariadb (alias mysql).</p>

<figure class='code'><figcaption><span>&#8220;instalando mysql&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum install mariadb-server mariadb</span>
</span><span class='line'><span class="go"> systemctl start mariadb</span>
</span><span class='line'><span class="go"> systemctl enable mariadb</span>
</span><span class='line'><span class="go"> mysql_secure_installation</span>
</span></code></pre></td></tr></table></div></figure>


<p>No tengo que explicar como funciona el comando <strong>mysql_secure_installation</strong>;
asumo que el lector <strong>no</strong> es retrasado mental. Configure el MySQL como más
cómodo le sea.</p>

<p>Finalmente, la guinda del pastel: <strong>PHP</strong>. Hay mil y una vertiente de como
instalar php en centos. Que si el repo remis, que si el ius, que si la versión
tal o la mascual, etc&hellip; En este caso asumiremos que se está instalando el php
genérico y no discutiremos nimiedades.</p>

<figure class='code'><figcaption><span>&#8220;php genérico&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum install php php-mysql php-fpm</span>
</span></code></pre></td></tr></table></div></figure>


<p>Antes de echarlo a andar, vamos a hacer unos cambios. En el fichero
<strong>/etc/php.ini</strong> buscamos una linea que dice <strong>cgi.fix_pathinfo</strong> y le ponemos
como valor 0.</p>

<figure class='code'><figcaption><span>&#8220;/etc/php.ini&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="na">cgi.fix_pathinfo</span><span class="o">=</span><span class="s">0</span>
</span></code></pre></td></tr></table></div></figure>


<p>A php-fpm también le vamos a dar unos toques finos. Localiza el fichero
<strong>/etc/php-fpm.d/www.conf</strong> y el parámetro <strong>listen</strong></p>

<figure class='code'><figcaption><span>&#8220;/etc/php-fpm.d/www.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="na">listen</span> <span class="o">=</span> <span class="s">/var/run/php-fpm/php-fpm.sock</span>
</span></code></pre></td></tr></table></div></figure>


<p>Además, localiza también ahí, las lineas <strong>listen.</strong>. Asegúrate de que corran
como el usuario <strong>nobody</strong>.</p>

<figure class='code'><figcaption><span>&#8220;/etc/php-fpm.d/www.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="na">listen.owner</span> <span class="o">=</span> <span class="s">nobody</span>
</span><span class='line'><span class="s"> listen.group = nobody</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pero eso era el suid de fpm, ahora vamos a setear el usuario del socket, que en
este caso será <strong>nginx</strong>.</p>

<figure class='code'><figcaption><span>&#8220;/etc/php-fpm.d/www.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="na">user</span>  <span class="o">=</span> <span class="s">nginx</span>
</span><span class='line'><span class="s"> group = nginx</span>
</span></code></pre></td></tr></table></div></figure>


<p>Arranca y habilita fpm.</p>

<figure class='code'><figcaption><span>&#8220;arranca fpm&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> systemctl enable php-fpm</span>
</span><span class='line'><span class="go"> systemctl start  php-fpm</span>
</span></code></pre></td></tr></table></div></figure>


<p>Siempre falta un puto &ldquo;.conf&rdquo; de nginx que pinche con php, así que aquí te pongo
uno bien genérico.</p>

<figure class='code'><figcaption><span>&#8220;nginx.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'>   <span class="c1"># redirector estático</span>
</span><span class='line'>   <span class="err">server</span> <span class="err">{</span>
</span><span class='line'>
</span><span class='line'>         <span class="err">listen</span>       <span class="err">80</span><span class="c1">;</span>
</span><span class='line'>         <span class="err">server_name</span>  <span class="err">fqdn_del_virtualhost</span><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'>         <span class="err">location</span> <span class="err">/</span> <span class="err">{</span>
</span><span class='line'>            <span class="err">return</span> <span class="err">301</span> <span class="err">https://$server_name$request_uri</span><span class="c1">;</span>
</span><span class='line'>         <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="err">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>   <span class="err">server</span> <span class="err">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># el directorio /etc/nginx/ssl/ contine los certificados</span>
</span><span class='line'>      <span class="err">ssl_certificate</span>      <span class="err">ssl/certificado.crt</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">ssl_certificate_key</span>  <span class="err">ssl/certificado.key</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">ssl_session_cache</span>    <span class="err">shared:SSL:1m</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">ssl_session_timeout</span>  <span class="err">5m</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">ssl_ciphers</span>  <span class="err">HIGH:!aNULL:!MD5</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">ssl_prefer_server_ciphers</span>  <span class="err">on</span><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># como me llamo y por donde escucho</span>
</span><span class='line'>      <span class="err">listen</span>       <span class="err">443</span> <span class="err">ssl</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">server_name</span>  <span class="err">fqdn_del_virtualhost</span><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># aquí pones el directorio donde está tu app</span>
</span><span class='line'>      <span class="err">root</span>   <span class="err">/var/www/html</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">index</span> <span class="err">index.php</span> <span class="err">index.html</span> <span class="err">index.htm</span><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># el root del servidor</span>
</span><span class='line'>      <span class="err">location</span> <span class="err">/</span> <span class="err">{</span>
</span><span class='line'>          <span class="na">try_files $uri $uri/</span> <span class="o">=</span><span class="s">404;</span>
</span><span class='line'><span class="s">      }</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>      <span class="c1"># los errores 404</span>
</span><span class='line'>      <span class="err">error_page</span> <span class="err">404</span> <span class="err">/404.html</span><span class="c1">;</span>
</span><span class='line'>      <span class="err">error_page</span> <span class="err">500</span> <span class="err">502</span> <span class="err">503</span> <span class="err">504</span> <span class="err">/50x.html</span><span class="c1">;</span>
</span><span class='line'>      <span class="na">location</span> <span class="o">=</span> <span class="s">/50x.html {</span>
</span><span class='line'><span class="s">          root /usr/share/nginx/html;</span>
</span><span class='line'><span class="s">      }</span>
</span><span class='line'><span class="s">      </span>
</span><span class='line'><span class="s">      # el fpm de php, la expresión regular suele dar perreta por el $</span>
</span><span class='line'><span class="s">      location ~ \.php$ {</span>
</span><span class='line'><span class="s">           try_files $uri =404;</span>
</span><span class='line'><span class="s">           fastcgi_pass unix:/var/run/php-fpm/php-fpm.sock;</span>
</span><span class='line'><span class="s">           fastcgi_index index.php;</span>
</span><span class='line'><span class="s">           fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span>
</span><span class='line'><span class="s">           include fastcgi_params;</span>
</span><span class='line'><span class="s">      }</span>
</span><span class='line'>
</span><span class='line'>   <span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Si quieres probarlo crea el fichero <strong>/var/www/html/index.php</strong> con algo clásico.</p>

<figure class='code'><figcaption><span>&#8220;/var/www/html/index.php&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'> <span class="o">&lt;?</span><span class="nx">php</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>Si te da un error que dice &ldquo;not input file especified&rdquo; puede ser rollo con
selinux o algo mal configurado en php fpm.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/07/23/lemp-en-debian/">LEMP en debian 9</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-07-23T15:19:47-04:00'><span class='date'>23/07/2017</span> <span class='time'>3:19 pm</span></time>
        
           | <a href="/blog/2017/07/23/lemp-en-debian/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/07/23/lemp-en-debian/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Resulta que <em>&ldquo;linux, apache, mysql y php&rdquo;</em>, solía llamarse L<strong>A</strong>MP. Ahora,
cuando cambian apache por ningx le llaman L<strong>E</strong>MP no se por qué (y no quiero
averiguarlo, la moda me enferma).</p>

<p>En debian 9, la rima de php con nignx cambia un poquito. No hay que ser un genio
para darse cuento que cosas como <em>php5</em> ahora son <em>php7</em>, pero como para mi este
blog es un sitio donde escribo el código para luego copiar y pegar, pondré como
hacerlo en el &ldquo;debian nuevo&rdquo;.</p>

<p>Vamos a empezar de atrás pa alante; el MySQL</p>

<figure class='code'><figcaption><span>&#8220;instalando sql y compañía&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> root@299c0ecdbedc:~# apt install mysql-server</span>
</span></code></pre></td></tr></table></div></figure>


<p>Uno de los cabezazos más grandes que me dí con debian 9 fue la configuración del
SQL. Ya no es asistido como antes. Así que vamos a correr un par de comandos.</p>

<figure class='code'><figcaption><span>&#8220;configurando mysql&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> root@299c0ecdbedc:~# mysql_install_db</span>
</span><span class='line'><span class="go"> root@299c0ecdbedc:~# mysql_secure_installation</span>
</span></code></pre></td></tr></table></div></figure>


<p>Al correr el segundo te saldrán unas cuantas preguntas. Respóndelas a tu gusto y
necesidad.</p>

<p>Ahora bien, conectar lo que No sea por el socket, se vuelve una jodienda. Por
ejemplo root@localhost suele no estar autorizado; si esto se interpreta como
127.0.0.1</p>

<p>Ejecuta: <strong>mysql -u root</strong> o con <strong>-p</strong> si seleccionaste tener password.</p>

<p>Veamos por ejemplo, que creamos el usuario <strong>admin</strong> para la base de datos
<strong>misdatos</strong>.</p>

<figure class='code'><figcaption><span>&#8220;creando «admin»&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">misdatos</span><span class="p">;</span>
</span><span class='line'><span class="k">CREATE</span> <span class="k">USER</span> <span class="s1">&#39;admin&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;secretisimo&#39;</span><span class="p">;</span>
</span><span class='line'><span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">PRIVILEGES</span> <span class="k">ON</span> <span class="n">misdatos</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">&#39;admin&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Si quieres saber los usuarios ejecuta la sentencia:</p>

<figure class='code'><figcaption><span>&#8220;ver los usuarios&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'> <span class="k">SELECT</span> <span class="k">User</span><span class="p">,</span><span class="k">Host</span><span class="p">,</span><span class="n">Password</span> <span class="k">FROM</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Bueno ya tenemos el SQL corriendo. Vamos pal resto</p>

<figure class='code'><figcaption><span>&#8220;instalando cosas&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">apt install nginx mysql-client php-fpm php-mysql libfcgi0ldbl</span>
</span></code></pre></td></tr></table></div></figure>


<p>Una vez que se instale <strong>php-fpm</strong> lo echamos a andar y lo probamos.</p>

<figure class='code'><figcaption><span>&#8220;probando fpm&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">root@299c0ecdbedc:~#</span> /etc/init.d/php7.0-fpm restart
</span><span class='line'><span class="gp">root@299c0ecdbedc:~#</span> cgi-fcgi -bind -connect /run/php/php7.0-fpm.sock
</span><span class='line'><span class="go">Content-type: text/html; charset=UTF-8</span>
</span></code></pre></td></tr></table></div></figure>


<p>Al virtualhost de nginx, le hacemos unos arreglitos; para que nginx tire el php
por fastcgi. Que ricura debian, tan solo incluyendo un snippet todo se resuelve.</p>

<figure class='code'><figcaption><span>&#8220;/etc/nginx/sites-available/default&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">server</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">listen</span> <span class="mi">80</span> <span class="nx">default_server</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">root</span> <span class="o">/</span><span class="kd">var</span><span class="err">/www/html;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">index</span> <span class="nx">index</span><span class="p">.</span><span class="nx">php</span> <span class="nx">index</span><span class="p">.</span><span class="nx">html</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">server_name</span> <span class="nx">_</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">location</span> <span class="o">/</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">try_files</span> <span class="nx">$uri</span> <span class="nx">$uri</span><span class="o">/</span> <span class="o">=</span><span class="mi">404</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="nx">location</span> <span class="o">~</span> <span class="err">\</span><span class="p">.</span><span class="nx">php$</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">include</span> <span class="nx">snippets</span><span class="o">/</span><span class="nx">fastcgi</span><span class="o">-</span><span class="nx">php</span><span class="p">.</span><span class="nx">conf</span><span class="p">;</span>
</span><span class='line'>                <span class="nx">fastcgi_pass</span> <span class="nx">unix</span><span class="o">:</span><span class="err">/var/run/php/php7.0-fpm.sock;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Reinicia nginx!</p>

<p>Pa probar que todo está pinchando, creamos un script que llame la función
<strong>phpinfo()</strong></p>

<figure class='code'><figcaption><span>&#8220;phpinfo()&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> root@299c0ecdbedc:~# /etc/init.d/nginx restart</span>
</span><span class='line'><span class="go"> root@299c0ecdbedc:~# /etc/init.d/php7.0-fpm restart</span>
</span><span class='line'><span class="go"> root@299c0ecdbedc:~# /etc/init.d/mysql restart</span>
</span><span class='line'><span class="go"> root@299c0ecdbedc:~# echo &#39;&lt;?php phpinfo(); ?&gt;&#39; &gt; /var/www/html/index.php</span>
</span></code></pre></td></tr></table></div></figure>


<p>Debes poder ver la típica página que produce <strong>phpinfo()</strong></p>

<p>Para probar la base de datos, creas un script de php que inicialice mysqli:</p>

<figure class='code'><figcaption><span>&#8221;&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'><span class="nv">$misql</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">);</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$misql</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">die</span><span class="p">(</span><span class="s1">&#39;esto no pincha: &#39;</span> <span class="o">.</span> <span class="nx">mysqli_error</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">echo</span> <span class="s1">&#39;Conexion satisfactoria&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nx">mysqli_close</span><span class="p">(</span><span class="nv">$misql</span><span class="p">);</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>Puedes correr ese script con php o llamarlo con el navegador. El resultado es
bastante obvio.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/06/29/repos-epel-y-demas/">repos EPEL y demás</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-06-29T02:15:03-04:00'><span class='date'>29/06/2017</span> <span class='time'>2:15 am</span></time>
        
           | <a href="/blog/2017/06/29/repos-epel-y-demas/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/06/29/repos-epel-y-demas/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>CentOS, es conocido por sus reducidos repositorios. Pero por suerte, los repos
EPEL (enterprise linux) y el IUS nos permiten bandearnos un poco. Además,
tenemos el Remi, tan fresco como explosivo, que si bien no es muy recomendable
usarlo, nunca está de más tenerlo a mano. Si algo tiene lindo <em>yum</em> es la
gestión de repositorios.</p>

<p>Instala <strong>wget</strong>&hellip; vamos a necesitarlo.</p>

<p>Para los criticones: -sí, ya se que el epel está en el repo oficial, pero para
este ejemplo lo añadiremos desde la web.</p>

<figure class='code'><figcaption><span>&#8220;añadiendo el EPEL&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> wget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span>
</span><span class='line'><span class="go"> rpm -Uvh epel-release-latest-7*.rpm</span>
</span></code></pre></td></tr></table></div></figure>


<p>El IUS es majomenos la misma historia</p>

<figure class='code'><figcaption><span>&#8220;añadiendo el IUS</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> wget https://centos7.iuscommunity.org/ius-release.rpm</span>
</span><span class='line'><span class="go"> rpm -Uvh ius-release*.rpm</span>
</span></code></pre></td></tr></table></div></figure>


<p>El repo IUS, suele contener paquetes más recientes de cosas que ya centos trae.
La mejor manera de instalar esto, es usando un plugin de yum, llamado «replace»,
así que instala el paquete <strong>yum-plugin-replace</strong>.</p>

<p>Ahora busca el paquete que deseeas en el repo IUS:</p>

<figure class='code'><figcaption><span>&#8220;buscando en el IUS&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum --disablerepo=&quot;*&quot; --enablerepo=&quot;ius&quot; search talcosa</span>
</span></code></pre></td></tr></table></div></figure>


<p>Luego remplaza el paquete <em>talcosa</em> de CentOS, por el <em>talcosa3u</em> de IUS</p>

<figure class='code'><figcaption><span>&#8220;remplazando paquete&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum replace talcosa --replace-with talcosa3u</span>
</span></code></pre></td></tr></table></div></figure>


<p>Para más detalles, échale un vistazo a <a href="https://ius.io/Usage/">el user-guide de IUS</a></p>

<p>El repositorio Remi es aún más peligroso, ya que los paquetes tienen el mismo
nombre que el de los oficiales. Se recomienda no tener el repo remi activado NI
JUGANDO.</p>

<p>La instalación es la misma rutina</p>

<figure class='code'><figcaption><span>&#8220;instalando Remi&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> wget http://rpms.famillecollet.com/enterprise/remi-release-7.rpm</span>
</span><span class='line'><span class="go"> rpm -Uvh remi-release-7*.rpm</span>
</span></code></pre></td></tr></table></div></figure>


<p>Otro repo bueno, es el de alcancelibre, que provee sarg.</p>

<figure class='code'><figcaption><span>&#8220;alcancelibre&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">wget -N http://www.alcancelibre.org/al/server/AL-Server.repo \</span>
</span><span class='line'><span class="go">-O /etc/yum.repos.d/AL-Server.repo</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Luego usamos el mismo proceder, buscar en repo específico.</p>

<figure class='code'><figcaption><span>&#8220;buscando paquetes&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">yum --enablerepo=remi search fulanito</span>
</span><span class='line'><span class="go">yum --enablerepo=remi install fulanito</span>
</span></code></pre></td></tr></table></div></figure>


<p>El comando <em>repolist</em> permite ver los repositorios en juego. Para ver los repos
que tienes acoplados, usa <strong>yum repolist</strong>. Si quieres ver que repo tienes
deshabilitados, usa <strong>yum repolist disabled</strong>.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/06/29/knockd-en-centos/">knockd en centos</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-06-29T02:06:34-04:00'><span class='date'>29/06/2017</span> <span class='time'>2:06 am</span></time>
        
           | <a href="/blog/2017/06/29/knockd-en-centos/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/06/29/knockd-en-centos/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Desafortunadamente, los repositorios oficiales de centos no traen port-knocking.
No queda más remiendo que usar un repo de terceros.</p>

<figure class='code'><figcaption><span>&#8220;/etc/yum.repos.d/nux-misc.repo&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> [root@proxy ~]# cat /etc/yum.repos.d/nux-misc.repo</span>
</span><span class='line'><span class="go"> [nux-misc]</span>
</span><span class='line'><span class="go"> name=Nux Misc</span>
</span><span class='line'><span class="go"> baseurl=http://li.nux.ro/download/nux/misc/el7/x86_64/</span>
</span><span class='line'><span class="go"> enabled=0</span>
</span><span class='line'><span class="go"> gpgcheck=1</span>
</span><span class='line'><span class="go"> gpgkey=http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro</span>
</span></code></pre></td></tr></table></div></figure>


<p>Luego para instalar, declaramos dicho repositorio como activo.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> yum --enablerepo=nux-misc install knock knock-server</span>
</span><span class='line'><span class="go"> systemctl enable knockd</span>
</span></code></pre></td></tr></table></div></figure>


<p>En mi caso, el /etc/knockd.conf me quedó así:</p>

<figure class='code'><figcaption><span>&#8220;/etc/knockd.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="k">[options]</span>
</span><span class='line'>   <span class="err">UseSyslog</span>
</span><span class='line'>   <span class="na">Interface</span> <span class="o">=</span> <span class="s">eth1</span>
</span><span class='line'>
</span><span class='line'> <span class="k">[abreme]</span>
</span><span class='line'>   <span class="na">sequence</span> <span class="o">=</span> <span class="s">111,222,333</span>
</span><span class='line'><span class="s">   tcpflags = syn</span>
</span><span class='line'><span class="s">   seq_timeout = 15</span>
</span><span class='line'><span class="s">   cmd_timeout = 8600</span>
</span><span class='line'><span class="s">   start_command = /sbin/iptables -I INPUT -s %IP% -j ACCEPT</span>
</span><span class='line'><span class="s">   stop_command =  /sbin/iptables -D INPUT -s %IP% -j ACCEPT</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nota para imbéciles: Cambia <strong>sequence</strong> por tu secuencia.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/06/28/android-islamico/">Apps islámicas android</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-06-28T23:52:26-04:00'><span class='date'>28/06/2017</span> <span class='time'>11:52 pm</span></time>
        
           | <a href="/blog/2017/06/28/android-islamico/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/06/28/android-islamico/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Si queremos decir <em>una aplicación islámica de android bien completa</em>, la que más
se acerca es sin duda es &ldquo;MuslimPro&rdquo;. Por tener, tiene hasta los 99 nombres de
dios, recitados con un corito de lo más lindo. Sin embargo, cosas <strong>sensillas</strong>
como cambiar el adhan, se vuelven complicadas. Si no te cuadran los 3 adhan que
trae, te jodiste, por que lo más bonitos son para la versión de pago.</p>

<p><img class="right" src="/images/muslim_daily.png" width="200" title="&#34;portada de Muslim Daily, note como falta la sesión de noticias&#34;" alt="&#34;portada de Muslim Daily, note como falta la sesión de noticias&#34;"></p>

<p>En mi opinión, el adhan debe sonar más enérgico de día, pero el adhan de Isha&#8217;a,
lo prefiero pasivo. Por ello, recomiendo más usar <a href="https://play.google.com/store/apps/details?id=com.honey.prayerassistant"><strong>Muslim Daily</strong></a>.
Antes contaba con una sesión de noticias muy interesante, que se adaptaba a tu
gusto como por arte de magia. No se por qué se la quitaron. También tiene la
Qibla y un calendario islámico bastante poco funcional por cierto; me costó
trabajo entender como conmutar las fechas.</p>

<p>Entre los 9 adhan que ofrece, tenemos el <em>Adhan Nasse Al Qatmi</em> muy apropiado
para Isha&#8217;a, suena bastante sereno.</p>

<p>El corán que esta aplicación provee en español es la traducción de Cortés; una
gran porquería en mi opinión. Pero de igual, si de coranes se trata, prefiero
<a href="https://play.google.com/store/apps/details?id=com.chaks.quran"><strong>El noble corán</strong></a>
Este cuenta con una buena gama de recitaciones en audio para todos los gustos.
Además, el texto en los tres idiomas.</p>

<p><img class="left" src="/images/chaksquran.png" width="200" title="&#34;«la apuertura» mostrando texto arábico, transliteración y traducción&#34;" alt="&#34;«la apuertura» mostrando texto arábico, transliteración y traducción&#34;"></p>

<p>Recuerda, que mientras la app esté mostrando el texto en árabe, será entonces
entonces un corán (no una traducción) y debes tener en cuenta el respeto que
esto amerita; así que nada de leer en el baño. También tiene gestor de aleyas
favoritas y permite añadirle notas.</p>

<p><img class="right" src="/images/arabe_chat.png" width="200" title="&#34;transcripción a alfabeto de chat&#34;" alt="&#34;transcripción a alfabeto de chat&#34;"></p>

<p>Pero lo que más me gusta es que tiene una transliteración escrita fonéticamente
con <a href="https://es.wikipedia.org/wiki/Alfabeto_de_chat_%C3%A1rabe">árabe de chat</a>.</p>

<p>Por si no lo sabes, esta es una manera de leer árabe con alfabeto latino. Es la
mejor transliteración, ya que fue creada por los árabes de manera espontanea. En
vez de valerse de dígrafos para representar las consonantes; usan simplemente
números. Por ejemplo, <em>ayn</em> (ع) es el 3 y la <em>ha</em> gutural (ح) con el 7. Además,
las vocales entre paréntesis, representan las vocales casi inaudibles que
acompañan de manera implícita a una consonante, como la «i» de la <em>mim</em> (م).</p>

<p>Por último, una aplicación de plegarias. Nada mal para afinar la fonética; la
aplicación <a href="https://play.google.com/store/apps/details?id=com.chaks.duaas"><strong>34 Duaas</strong></a>.</p>

<p>Conclusión, el corán transliterado con árabe de chat de com.chaks.quran, es un
batazo y los adhanes de com.honey.prayerassistant son más variados.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/06/22/curiosa-acl-de-squid/">squid y navegar a .cu</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-06-22T00:17:11-04:00'><span class='date'>22/06/2017</span> <span class='time'>12:17 am</span></time>
        
           | <a href="/blog/2017/06/22/curiosa-acl-de-squid/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2017/06/22/curiosa-acl-de-squid/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Aveces las necesidades de nuestros clientes, son tan raras que nos dejan
anonadados. Pero ante necesidades extravagantes; soluciones extravagantes.  Este
post me lo dejo a modo de reflexión, para recordar; que muchas veces, el ingenio
combinado con la simpleza, puede desembocar en soluciones tan hermosas como
raras.</p>

<p>Es común, que en algunos lugares, la navegación a sitios &ldquo;.cu&rdquo; no requiera
autenticación. Aveces poner una ACL como esta</p>

<figure class='code'><figcaption><span>&#8220;squid.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="err">acl</span> <span class="err">cuba</span> <span class="err">url_regex</span> <span class="err">\.cu</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">allow</span> <span class="err">cuba</span>
</span></code></pre></td></tr></table></div></figure>


<p>Aparentemente <em>matamos la jugada</em>, pero luego, metemos una ACL relacionada con
usuarios autenticados y se jodió bicicleta.</p>

<p>El cartel de &ldquo;por favor autentique&rdquo; cae a cuanto &ldquo;.cu&rdquo; se navegue.</p>

<p>Pero tocando el <em>squid.conf</em>, vi esta cosa hermosa</p>

<figure class='code'><figcaption><span>&#8220;squid.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="c1">#   acl aclname localport 3128  # TCP port the client connected to [fast]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Decidí que los que vallan a navegar con autenticación, usarán el puerto 8080 y
los vuelos nacionales saldrán por el 3128.</p>

<p>De esta manera, se hace una ACL que niegue las peticiones NO cubanas <strong>sin mostrar
el puto login</strong>.</p>

<figure class='code'><figcaption><span>&#8220;squid.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'> <span class="c1"># aquellos que se conectan por el puerto 3128</span>
</span><span class='line'> <span class="err">acl</span> <span class="err">mortales</span> <span class="err">localport</span> <span class="err">3128</span>
</span><span class='line'>
</span><span class='line'> <span class="c1"># aquellos que se conectan por el 8080</span>
</span><span class='line'> <span class="err">acl</span> <span class="err">olimpo</span> <span class="err">localport</span> <span class="err">8080</span>
</span><span class='line'>
</span><span class='line'> <span class="c1"># los sitios a los que se entran sin contraseña</span>
</span><span class='line'> <span class="err">acl</span> <span class="err">cuba</span> <span class="err">url_regex</span> <span class="err">-i</span> <span class="err">&quot;/etc/squid3/cuba.lst&quot;</span>
</span><span class='line'>
</span><span class='line'> <span class="c1"># CUBANOS</span>
</span><span class='line'> <span class="c1"># lo que valla a cuba,</span>
</span><span class='line'> <span class="c1"># sale sin autenticación</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">allow</span> <span class="err">mortales</span> <span class="err">cuba</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">allow</span> <span class="err">CONNECT</span> <span class="err">mortales</span> <span class="err">cuba</span>
</span><span class='line'>
</span><span class='line'> <span class="c1"># deniega a los mortales, lo que no sea cuba</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">deny</span> <span class="err">mortales</span> <span class="err">!cuba</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">deny</span> <span class="err">CONNECT</span> <span class="err">mortales</span> <span class="err">!cuba</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> <span class="c1"># PRIVILEGIADOS</span>
</span><span class='line'> <span class="c1"># lo que NO valla para cuba debe autenticarse</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">allow</span> <span class="err">CONNECT</span> <span class="err">olimpo</span> <span class="err">autenticados</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">allow</span> <span class="err">olimpo</span> <span class="err">autenticados</span>
</span><span class='line'>
</span><span class='line'> <span class="c1"># y más nada pasa</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">deny</span> <span class="err">CONNECT</span> <span class="err">all</span>
</span><span class='line'> <span class="err">http_access</span> <span class="err">deny</span> <span class="err">all</span>
</span><span class='line'> <span class="err">icp_access</span> <span class="err">deny</span> <span class="err">all</span>
</span></code></pre></td></tr></table></div></figure>


<p>¿Se entendió? Pasa que squid, al hacerle cualquier petición, que involucre
internet, le mostrará al pobre <em>puntoseunauta</em> el cuadro de diálogo, ya que
para acceder a internet real requiere autenticación; y squid te da la
posibilidad probar que eres <em>usuario de internet</em>. Para evitar esta conducta,
ponemos una cláusula permitiendo que los &ldquo;.cu&rdquo; usando el 3128, pasan. Luego
ponemos otra ACL negando el acceso a lo que <strong>NO</strong> sea .cu por el mismo puerto.
De esta manera, los que tengan solo acceso &ldquo;.cu&rdquo;, usarán el 3128 y la ACL que
involucra autenticación nunca es probada.</p>

<p>Para los autenticados, pusimos una ACL que machea el puerto 8080. O sea, los
usuarios de internet, al hacer su peticiones por el puerto 8080, enseguida las
pedirá autenticación.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.003 BTC: <a href="https://blockchain.info/address/1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ">1LgL9cfT2StNk9gdedMJZseMnKJCEgQJdQ</a> </p>

    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/3">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/index.html">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>

	<h1>Lo m&aacute;s reciente</h1>

	<ul id="recent_posts">

		

		<li class="post">
			<a href="/blog/2017/11/30/segwit-con-3-star-en-electrum/">segwit con p2sh en electrum</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/11/30/segwit-confusion/">segwit y la confusión</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/11/04/install-pandorafms/">instalando pandorafms</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/09/01/daloradius-y-sus-amigos/">daloradius y sus amigos</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/08/14/odoo-en-centos7/">odoo en centos7</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/08/13/yum-estrecho/">yum estrecho</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/07/24/lemp-en-centos/">LEMP en Centos 7</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/07/23/lemp-en-debian/">LEMP en debian 9</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/06/29/repos-epel-y-demas/">repos EPEL y demás</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/06/29/knockd-en-centos/">knockd en centos</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/06/28/android-islamico/">Apps islámicas android</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/06/22/curiosa-acl-de-squid/">squid y navegar a .cu</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/05/13/instalar-node-rapido/">instalar node rápido</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/05/10/ssl-ca-local/">autoridad certificadora</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/04/08/xen-y-virt-manager/">xen y virt-manager</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/29/jugar-teeworlds-en-lan/">jugar teeworlds en LAN</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/17/nueva-vm-siempre-es-pv/">nueva VM siempre es PV</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/04/rainloop-en-debian/">rainloop en debian</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/03/nginx-y-websocket/">nginx y websocket</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/03/pkg-tras-un-proxy/">pkg tras un proxy</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/01/portknocking-en-freebsd/">portknocking en freebsd</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/01/bind-en-infomed/">bind en infomed</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/03/01/qos-con-tc/">QoS con tc o dummynet</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/02/22/bind-personal/">bind personal</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/02/05/dns-con-vistas/">dns con vistas</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/02/01/ipfw-simple-y-consiso/">ipfw simple y conciso</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/28/freebsd-11/">mis crónicas con freebsd</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/21/palito/">animación del palito</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/20/datatables-espanol/">DataTables en español</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/09/tendencias-tecnologicas/">tendencias tecnológicas</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/09/flasheando-modem-al-s4/">flasheando modem al S4</a>
      </li>

      

		<li class="post">
			<a href="/blog/2017/01/02/rails-assets/">rails-assets</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/12/29/xgproyect/">xgproyect</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/12/27/cambiar-mac-a-un-nano/">cambiar mac a un nano</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/12/19/phpmyadmin-multiples-servidores/">phpmyadmin múltiples servidores</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/12/19/iptables-y-ftp/">iptables y ftp</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/12/09/rails-en-alpine/">rails en alpine</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/11/24/squid3-bloquear-user-agent/">squid3 bloquear user-agent</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/11/22/redimensionar-lvm/">redimensionar lvm</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/11/20/sysinfo-en-el-motd/">sysinfo en el motd</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/11/14/openvpn-user-plus-pass/">openvpn user+pass</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/el-domain-pop/">recolección DomainPOP</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/domainpop-con-postfix/">domainpop con postfix</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/tunel-6in4/">túnel 6in4</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/cortafuegos-ipv6-sencillo/">cortafuegos ipv6 sencillo</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/poniendo-direcciones-ipv6/">las reglas del juego ipv6</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/22/ipv6/">la resolución 185/2016</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/10/04/dirver-broadcom/">driver broadcom</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/09/22/audifonos-blutu/">audífonos blutú</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/09/16/dispatcher-script/">dispatcher script</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/08/16/password-de-windows/">password de windows</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/08/15/repositorio-de-iso-en-xen/">Local ISO en XenServer</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/07/31/kiwix-como-servicio/">kiwix como servicio</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/07/17/hibernar-en-archlinux/">hibernar en archlinux</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/07/17/rsync-basico/">rsync básico</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/06/20/correos-del-cron/">correos del cron</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/06/18/dkim-y-spf-en-postfix/">dkim y spf en postfix</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/06/06/desacelerar-mouse/">desacelerar mouse</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/05/12/deshabilitar-historial-de-bash/">deshabilitar historial de bash</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/04/29/reparar-archivos-de-innodb/">reparar archivos de innodb</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/04/01/wpa2-con-freeradius/">WPA2 con freeradius</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/03/14/misterio-con-ethernet-foxconn/">misterio con ethernet foxconn</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/03/07/cargar-rvm/">cargar rvm</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/02/22/data-confirm-en-un-boton/">data confirm en un boton</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/02/20/hooks-de-pacman/">los hooks de pacman</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/02/01/arch-compartir-paquetes/">arch compartir paquetes</a>
      </li>

      

		<li class="post">
			<a href="/blog/2016/01/25/hostname-arbitrario-en-bind9/">bind9, registro arbitratio</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/12/14/servidor-jabber-con-prosody/">servidor jabber con prosody</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/11/29/mc-demora-en-abrir/">mc demora en abrir</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/11/23/desmume-ultralento/">desmume ultralento</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/11/12/rc-dot-local-en-systemd/">rc.local en systemd</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/11/03/las-mujeres-gordas/">las mujeres gordas</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/11/03/tls-y-ssl-en-postfix/">tls y ssl en postfix</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/10/20/compartir-la-wifi/">compartir la wifi</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/10/18/systemd-timesyncd/">systemd-timesyncd</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/10/15/repo-de-fdroid/">repo de fdroid</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/10/08/prawn-pdf-con-ruby/">prawn, pdf con ruby</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/09/17/dhcp-por-grupos/">dhcp por grupos</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/09/10/plymouth-boot-screen/">plymouth boot screen</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/09/07/git-clone-rapido/">git clone rápido</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/09/07/archlinux-dos-kernel/">archlinux con dos kernel</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/08/28/compute-remote-uptime/">compute remote uptime</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/07/24/transliteracion-del-coran/">transliteración del corán</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/07/12/date-select-en-espanol/">date_select en español</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/07/11/openvas-en-archlinux/">OpenVAS en Archlinux</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/07/05/anadir-verbo-a-un-scaffold/">añadir verbo a un scaffold</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/06/30/bootstrap-en-rails-4/">bootstrap en rails 4</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/06/21/se-dice-dios-no-ala/">se dice DIOS, no alá</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/06/01/pacman-bajo-el-microscopio/">pacman bajo el microscopio</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/05/28/cambiar-user-agent-en-squid/">cambiar user agent con squid</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/05/26/nic-bonding/">NIC bonding</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/05/23/ltsp-en-debian8-y-salud/">ltsp en debian8 y salud</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/02/21/sasl-homeclub-only/">SASL homeclub only</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/02/19/delay-pools-de-squid/">delay pools de squid</a>
      </li>

      

		<li class="post">
			<a href="/blog/2015/02/06/zentyal/">Zentyal</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/10/28/proxy-automatico/">proxy automático</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/09/24/verdial-y-el-imagis/">la pena de verdial</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/09/05/palos-de-wordpress/">palos de wordpress</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/08/25/el-server-de-correo/">el servidor de correo</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/08/15/subdesarrollo/">subdesarrollo</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/08/11/ocs-inventory/">ocs-inventory</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/07/08/select-en-bootstrap/">select en bootstrap</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/07/05/empirico/">empíricos</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/06/10/autenticador-sql-en-el-proxy/">autenticador SQL en el proxy</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/06/09/postfix-entrando-en-el-baile/">postfix entrando en el baile</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/06/09/dovecot-entra-en-el-baile/">dovecot entra en el baile</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/05/02/wordpress-para-todos/">wordpress para todos</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/04/18/lxc-en-salud/">lxc en salud</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/04/06/squid-en-infomed/">el toten de proxies</a>
      </li>

      

		<li class="post">
			<a href="/blog/2014/04/04/en-la-cumbre-del-vedado/">el &#8220;calisto&#8221; garcía</a>
      </li>

      

   </ul>

</section>





  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - låzaro -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'uranio-235';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</body>
</html>
