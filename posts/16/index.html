
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>El SysAdmin del 3er Mundo</title>
  <meta name="author" content="låzaro">

  
  <meta name="description" content="empíricos 05/07/2014 9:18 am | Comments ¿Sabes tú qué es un &ldquo;empírico&rdquo;? Una persona que desarrolla habilidades de manera autodidacta en &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://uranio-235.github.io/posts/16/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="El SysAdmin del 3er Mundo" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">El SysAdmin del 3er Mundo</a></h1>
  
    <h2>todo lo que expliqué mientras nadie prestaba atención</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://www.google.com" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="uranio-235.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/archives">Archivo</a></li>
  <li><a href="/blog/categories/rails/">Ruby on Rails</a></li>
  <li><a href="/blog/categories/islam/">Islam</a></li>
  <li><a href="/blog/categories/destacado/">Destacado</a></li>
  <li><a href="/blog/categories/razonemos/">Razonemos</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/05/empirico/">empíricos</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-07-05T09:18:42-04:00'><span class='date'>05/07/2014</span> <span class='time'>9:18 am</span></time>
        
           | <a href="/blog/2014/07/05/empirico/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/07/05/empirico/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>¿Sabes tú qué es un &ldquo;empírico&rdquo;?</p>

<p>Una persona que desarrolla habilidades de manera autodidacta en un oficio o
campo de la ciencia y que llega a ser tanto o más bueno que un catedrático.</p>

<p>Generalmente estamos graduados de algo que no ejercemos.</p>

<p>Guardamos con devoción en nuestra casa, el libro que nos darían si llegáramos al
tercer año de la carrera universitaria que deberíamos estudiar.</p>

<p>No leemos los libros que nos obligan. Leemos los que nos interesan.</p>

<p>No podemos ir a la universidad porque suspendemos las pruebas en las que nos
preguntan cosas que hace 6 años leímos o cosas que No nos interesan.</p>

<p>Cuando llegamos a preescolar sabíamos las vocales, los colores y contar del uno
al diez. Odiábamos a la profesora por obligarnos a atender su aburrida clase.</p>

<p>Somos gente que pensamos diferentes y no encajamos en el montón. Algunos nos
llaman &ldquo;rosca izquierda&rdquo; otros nos llaman &ldquo;originales&rdquo;.</p>

<p>Sabemos que colar un café es una reacción exotérmica porque dimos química en
noveno grado.</p>

<p>Sabemos que de día sopla la brisa y de noche el terral, porque dimos &ldquo;mundo en
que vivimos&rdquo; en 5to grado.</p>

<p>VAMOS A LA ESCUELA A APRENDER, no a sacar buenas notas.</p>

<p>No nos expliques nada, solo déjanos ver como lo haces.</p>

<p>Sabemos hacer muy pocas cosas pero no tenemos rivales en las pocas que hacemos.</p>

<p>Si hay un camino a la derecha y otro a la izquierda, hacemos uno nuevo por el
medio; con la esperanza de hacerlo mejor.</p>

<p>No somos mejores ni peores que nadie porque no nos comparamos.</p>

<p>Tenemos una ortografía terrible porque escribimos en cualquier idioma menos en
el nuestro.</p>

<p>Sabemos un montón de cosas y no nos acordamos cuando o porque lo aprendimos.</p>

<p>Los que nos aprecian o admiran nos llaman &ldquo;geniales&rdquo; o &ldquo;inteligentes&rdquo;. Los que
nos repudian o envidian nos llaman &ldquo;autosuficientes&rdquo; o &ldquo;excéntricos&rdquo;.</p>

<p>Solo somos &ldquo;empíricos&rdquo;</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.06 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/10/autenticador-sql-en-el-proxy/">autenticador SQL en el proxy</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-10T15:26:38-04:00'><span class='date'>10/06/2014</span> <span class='time'>3:26 pm</span></time>
        
           | <a href="/blog/2014/06/10/autenticador-sql-en-el-proxy/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/06/10/autenticador-sql-en-el-proxy/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>De siempre, me ha parecido que los autenticadores de squid son unas
canchanfletas. Realmente antes me parecían otra cosa, porque la palabra
&ldquo;canchanfleta&rdquo; no existía, pero nunca me simpatizaron mucho los autenticadores.</p>

<p>El hecho de que para administrar los usuarios se necesite una aplicación aparte
y por lo general bien estrafalaria; es por si solo una verdadera jodienda.</p>

<p>El despliegue aquí en el Calixto fue prácticamente una locura. Todo a la
carrera. A pesar de eso, escribí un autenticador de lo mas chulo. Al enviarle
como argumento un usuario, generaba una contraseña firme y creaba un fichero
bajo el directorio &ldquo;/etc/squid/digest/&rdquo;. El nombre de dicho fichero era el
nombre de usuario y el contenido: un digest irreversible (el password).</p>

<h3>Problema 1:</h3>

<p>La necesidad de crear usuarios y cambiar contraseñas, pujaba la necesidad de
una mecanismo más óptimo. El problema era correr ruby on rails en el server
para manejar los usuarios; matar moscas a cañonazos. El rails podía crear los
ficheros en mi máquina y luego cotejarlo con el servidor manualmente con &ldquo;scp&rdquo;,
lo cual seguía siendo un fastidio. Además NO SE POR QUE, después de crear un
usuario, había que reiniciar el servidor, muy a pesar de que el directorio se
releía cada vez que se pedía un usaurio.</p>

<p>Sumado a eso, la evidente aparición de un presunto servidor de correo y la
inspiración que resulta el esquema de infomed; me dejaron caer una vieja escupía
en la frente; yo que era tan renuente a SQL.</p>

<p>Bueno, todos los usuarios pa una base de datos y problema resuelto.</p>

<p>Además, tengo planificado más de un servicio, así que alé por el típico esquema
de una cuenta para todos los servicios.</p>

<figure class='code'><figcaption><span>&#8220;consulta SQL para ver el password&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="k">SELECT</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="ss">&quot;fulanito&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>La cantidad de código del autenticador se redujo considerablemente y con ello
el margen de error. La cuestión quedó sencilla: Una consulta SQL que determina
si el usuario está en la base de datos y si tiene permisos de navegación. En
futuro si se requiere un sistema de quotas, saldrá por ahí también.</p>

<h3>Problema 2:</h3>

<p>Pero entonces surgió un nuevo problema. Cuba, tierra de salvajes apagones y
feroces mosquitos. La luz falla y la máquina del informático se cae. Cuando el
autenticador comete algún error, squid dice que el autenticador está fallando y
lo deja de pinchar. Aún si arrancase la base de datos, squid no vuelve a echar a
andar el autenticador.</p>

<p>Entonces volvemos a lo mismo: -lazarito! no hay internet??! Junto a un nagios
histérico que manda correos a diestra y siniestra. PÁFATA! De vuelta al
subdesarrollo, ssh pal servidor y &ldquo;squid -k reconfigure&rdquo;</p>

<h3>Solución:</h3>

<p>El autenticador debe seguir en pie, aún cuando la base de datos no sea
accesible.</p>

<p>La única forma de lograr esto de forma transparente hacia squid; es verificar si
la conexión a la base de datos está operacional y denegar todas las
autenticaciones si esta no lo estuviere.</p>

<h3>Implementación:</h3>

<p>Pero un autenticador de squid, es un ciclo infinito que lee stdin y habla por
stdout; cargar una subrutina de rescate en cada vuelta, sería caerle a puñaladas
a la memoria RAM.</p>

<p>Solución: En cada vuelta, se compruebe si la base de datos está en linea. En
caso de no estarlo, se llama una función que establece la conexión. Este es un
iterador que intentará establecer la conexión hasta que lo logre. Mientras tanto
toda la autenticación en el proxy será &ldquo;usuario no válido&rdquo;.</p>

<figure class='code'><figcaption><span>&#8220;scope del iterador principal, bifurcador de reconexión&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">if</span> <span class="n">my</span>
</span><span class='line'>   <span class="vi">@auth</span><span class="o">=</span><span class="kp">false</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'>   <span class="k">begin</span>
</span><span class='line'>      <span class="n">my</span> <span class="o">=</span> <span class="no">Mysql</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;10.1.1.14&#39;</span><span class="p">,</span> <span class="s1">&#39;usuario&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;basededatos&#39;</span><span class="p">)</span> <span class="k">rescue</span> <span class="kp">false</span>
</span><span class='line'>   <span class="k">rescue</span>
</span><span class='line'>      <span class="no">STDERR</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;ERR Fallo la conexión al servidor SQL </span><span class="si">#{</span><span class="vg">$!</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="no">STDERR</span><span class="o">.</span><span class="n">flush</span>
</span><span class='line'>      <span class="k">next</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'><span class="k">end</span> <span class="c1"># if sql</span>
</span></code></pre></td></tr></table></div></figure>


<p>El iterador principal sigue viendo la variable que hace como semáforo (&ldquo;my&rdquo; en
este caso) en false y no se toma la molestia de encuestar una base de datos que
ya sabe; está off-line. La variable &ldquo;my&rdquo; será false mientras no se redeclare con
la conexión de Mysql.new. No confundir con @auth que en este caso es el valor
por definicion de la autenticacion. Osea, no se autenticó.</p>

<p>La variable <em>my</em> será true cuando la función logre establecer la conexión con
la base de datos.</p>

<p>De está forma, falla de manera silente, segura y controlada.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.03 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/09/postfix-entrando-en-el-baile/">postfix entrando en el baile</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-09T15:19:03-04:00'><span class='date'>09/06/2014</span> <span class='time'>3:19 pm</span></time>
        
           | <a href="/blog/2014/06/09/postfix-entrando-en-el-baile/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/06/09/postfix-entrando-en-el-baile/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>En el episodio anterior, vimos como dovecot se sumaba al esquema mysql. Faltaría
solamente postfix, para tener entonces un &ldquo;completo servidor MySQL&rdquo;</p>

<p>Cabe reconocer que el futuro de MySQL es incierto, pero meintras PostGres sea la
gran basura que es, que conmigo ni cuenten.</p>

<p>Normalmente postfix, entrega a través de procmail, pero ahora, nuestro dovecot
con sus flamantes características, tendrá una manera más compleja de entregar.
Por tanto, debemos usar el LDA (Local Deliver Agent) de Dovecot como el MDA por
defecto de postfix.</p>

<p>Al fichero <em>/etc/postfix/main.cf</em> le agregamos en el fondo un nuevo transport.</p>

<figure class='code'><figcaption><span>/etc/postfix/master.cf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'><span class="err">dovecot</span> <span class="err">unix</span> <span class="err">-</span> <span class="err">n</span> <span class="err">n</span> <span class="err">-</span> <span class="err">-</span> <span class="err">pipe</span>
</span><span class='line'>  <span class="na">flags</span><span class="o">=</span><span class="s">DRhu user=vmail:vmail argv=/usr/lib/dovecot/deliver -f ${sender} -d ${user}@${domain} -m ${extension}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Además de lo usual, al main.cf le declaramos que su nuevo transporte es  un tal
&ldquo;dovecot&rdquo; y le agregaremos unas cuantas gangarreas extras que ya explicaré.</p>

<figure class='code'><figcaption><span>/etc/postfix/main.cf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'><span class="c1"># el resto de tu confuiguracion arriba</span>
</span><span class='line'><span class="na">virtual_transport</span><span class="o">=</span><span class="s">dovecot</span>
</span><span class='line'><span class="na">mailbox_command</span> <span class="o">=</span> <span class="s">/usr/lib/dovecot/deliver</span>
</span><span class='line'><span class="na">mydestination</span> <span class="o">=</span> <span class="s">localhost, blackjack</span>
</span><span class='line'><span class="na">virtual_mailbox_domains</span> <span class="o">=</span> <span class="s">hcg.sld.cu</span>
</span><span class='line'><span class="na">virtual_mailbox_maps</span> <span class="o">=</span> <span class="s">$virtual_mailbox_domains</span>
</span><span class='line'><span class="na">virtual_alias_maps</span> <span class="o">=</span> <span class="s">hash:/etc/aliases</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Un comentario a prueba de imbéciles.</li>
<li>Declaramos el nuevo transporte para el dominio virtual.</li>
<li>Declaramos además, que se use el LDA de dovecot.</li>
<li>Declaramos que solo localhost y blackjack son destinos locales.</li>
<li>El dominio virtual será &ldquo;hcg.sld.cu&rdquo;.</li>
<li>Y lo mapeamos igual.</li>
<li>Por último, lo alias se quedan en el fichero tradicional.</li>
</ol>


<p>Ahora si creamos un usaurio llamado &ldquo;usuario&rdquo; en la base de datos;
usuario@localhost no será válido porque solo existe en el domino virtual.</p>

<p>Además, le agregamos que los alisas, son un hash en /etc/alisas, al estilo
antiguo. No vamos a cargar la base de datos con los alisases. Sobre todo
teniendo en cuenta lo pocos que son. De esta forma, cuando por ejemplo, se manda
un correo a root que es una alias de lazaro, postfix preguntara quien es lazaro
y responderá un usaurio del dominio virtual. Genial eh?</p>

<p>Tanto los alisas como los dominios virtuales, podrían ser tablas de MySQL, pero
como mi aplicación no maneja eso, lo haces al estilo tradicional. En caso de que
más adelante desarrollase algún esquema tipo proveedor de servicios; otro gallo
cantaría.</p>

<p>No olvidemos &ldquo;postfix reload&rdquo;</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.03 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/06/09/dovecot-entra-en-el-baile/">dovecot entra en el baile</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-06-09T08:56:43-04:00'><span class='date'>09/06/2014</span> <span class='time'>8:56 am</span></time>
        
           | <a href="/blog/2014/06/09/dovecot-entra-en-el-baile/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/06/09/dovecot-entra-en-el-baile/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Otra escupía que me cae en la frente. Desde que conozco linux, estoy oyendo
hablar de postfix con ldap, postfix con mysql y siempre mi criterio era el peor.</p>

<p>Por lo general, veía a mis paisanos copiar guías y pasar mil trabajos creando la
base de datos sin tener una finalidad útil. Ahora me doy cuenta que en un
esquema monstruosamente grande; MySQL resulta útil.</p>

<p>Por ejemplo, aquí tengo planificado un gran despliegue de tecnología
estrafalaria y voy a necesitar un esquema como el de google:</p>

<h3>&ldquo;una cuenta para todos los servicios&rdquo;</h3>

<p>Por el momento le va tocando el turno al correo, que aunque aún no tenemos
operando el dominio; esta pronto a cumplirse.</p>

<p>Primero y principioso, instalar todo:</p>

<figure class='code'><figcaption><span>&#8220;instalar todo&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@blackjack:~# aptitude install postfix-mysql dovecot-mysql
</span></code></pre></td></tr></table></div></figure>


<p>Seguidamente crearemos los usaurios del sistema. El esquema vmail corre como un
usaurio aparte por una cuestión de seguridad.</p>

<figure class='code'><figcaption><span>&#8220;crear los usaurios&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">root@blackjack:~#</span> groupadd -g <span class="m">5000</span> vmail
</span><span class='line'><span class="gp">root@blackjack:~#</span> useradd -g vmail -u <span class="m">5000</span> vmail -d /var/vmail
</span><span class='line'><span class="gp">root@blackjack:~#</span> mkdir /var/vmail
</span><span class='line'><span class="gp">root@blackjack:~#</span> chown vmail:vmail /var/vmail
</span></code></pre></td></tr></table></div></figure>


<p>La base de datos, tienes más o menos esta estructura:</p>

<figure class='code'><figcaption><span>&#8220;estructura de las base de datos&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">lazaro@leviatan:~/ejemplo$</span> rails console
</span><span class='line'><span class="go">Loading development environment (Rails 4.1.1)</span>
</span><span class='line'><span class="go">irb(main):001:0&gt; User.column_names</span>
</span><span class='line'><span class="go">=&gt; [&quot;id&quot;, &quot;username&quot;, &quot;realname&quot;, &quot;password&quot;, &quot;created_at&quot;, &quot;updated_at&quot;, &quot;telefono&quot;, &quot;correo&quot;, &quot;quota&quot;]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lo que más nos interesa de aquí es username y password, sobre todo teniendo en
cuenta que que se almacena cifrado, osea, un chorro de mierda hexagesimal.</p>

<p>Ahora vamos al fichero &ldquo;/etc/dovecot/conf.d/10-auth.conf&rdquo;. al fondo, le
descomentamos el autenticador sql y le comentamos el de pam. Nos quedaría así</p>

<figure class='code'><figcaption><span>&#8220;fondo de 10-auth.conf&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#!include auth-system.conf.ext</span>
</span><span class='line'><span class="o">!</span><span class="n">include</span> <span class="n">auth</span><span class="o">-</span><span class="n">sql</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">ext</span>
</span><span class='line'><span class="cp">#!include auth-ldap.conf.ext</span>
</span><span class='line'><span class="cp">#!include auth-passwdfile.conf.ext</span>
</span><span class='line'><span class="cp">#!include auth-checkpassword.conf.ext</span>
</span><span class='line'><span class="cp">#!include auth-vpopmail.conf.ext</span>
</span><span class='line'><span class="cp">#!include auth-static.conf.ext</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ahora le diremos al autenticador como conectarse a la base de datos. El irá
solito a buscar la table &ldquo;users&rdquo;. Especificamos las conexión. También le diremos
las linea sql que debe tirar para buscar el username y el password.</p>

<p>También modificaremos el mecanismo de cifrado, le diremos que use SHA256 que es
el generado por Ruby en mi esquema.</p>

<figure class='code'><figcaption><span>/etc/dovecot/dovecot-sql.conf.ext</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">connect</span> <span class="o">=</span> <span class="n">host</span><span class="o">=</span><span class="mf">10.1.1.14</span> <span class="n">dbname</span><span class="o">=</span><span class="n">labasededatos</span> <span class="n">user</span><span class="o">=</span><span class="n">usuario</span> <span class="n">password</span><span class="o">=</span><span class="n">notelodir</span><span class="err">é</span>
</span><span class='line'><span class="n">default_pass_scheme</span> <span class="o">=</span> <span class="n">SHA256</span>
</span><span class='line'><span class="n">password_query</span> <span class="o">=</span> \
</span><span class='line'>  <span class="n">SELECT</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> \
</span><span class='line'>  <span class="n">FROM</span> <span class="n">users</span> <span class="n">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="err">&#39;</span><span class="o">%</span><span class="n">n</span><span class="err">&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Por último y antes de pasar a postfix. En el fichero conf.d/auth-sql.conf.ext
declaramos como se gestionará la base datos.</p>

<figure class='code'><figcaption><span>&#8220;/etc/dovecot/conf.d/auth-sql.conf.ext&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">passdb</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">driver</span> <span class="o">=</span> <span class="n">sql</span>
</span><span class='line'>  <span class="n">args</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dovecot</span><span class="o">/</span><span class="n">dovecot</span><span class="o">-</span><span class="n">sql</span><span class="p">.</span><span class="n">conf</span><span class="p">.</span><span class="n">ext</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">userdb</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">driver</span> <span class="o">=</span> <span class="k">static</span>
</span><span class='line'>  <span class="n">args</span> <span class="o">=</span> <span class="n">uid</span><span class="o">=</span><span class="n">vmail</span> <span class="n">gid</span><span class="o">=</span><span class="n">vmail</span> <span class="n">home</span><span class="o">=/</span><span class="n">var</span><span class="o">/</span><span class="n">vmail</span><span class="o">/%</span><span class="n">n</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Osea que el correo se almacene en /var/vmail/fulano y con usuario vmail. De
hecho TODO el correo se almacenará con el usuario vmail; poniendo fin al
perpetuo temor de escalada de permisos que descansa en el típico esquema
/var/mail/fulano</p>

<p>En este caso, se chequeará el password contra SQL pero el almacenamiento se
hará en /var/vmail, con eso no vamos contra el princpio del cual siempre me
agarro y es que las Bases de datos, NO son sistemas de archivos.</p>

<p>Veremos en la próxima entrada, como se hace a postfix jugar con todo esto&hellip;</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.04 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/02/wordpress-para-todos/">wordpress para todos</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-05-02T13:51:13-04:00'><span class='date'>02/05/2014</span> <span class='time'>1:51 pm</span></time>
        
           | <a href="/blog/2014/05/02/wordpress-para-todos/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/05/02/wordpress-para-todos/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recién se ha puesto de moda, en el mundo entero, &ldquo;wordpress&rdquo;. No hace mucho leí
un twit de no se que perico de los palotes; diciendo que el 22% de los sitios en
internet son wordpress.</p>

<p>En infomed wordpress es un boom. Incluso se escriben plugins y temas para
wordpress.</p>

<p>Al llegar aquí me encontré con un drupal tirado en una IP detrás de un
&ldquo;/intranet&rdquo; y con un estado de abandono tremendo. Ni siquiera había un DNS
así que ni hablar de virtualhost.</p>

<p>Lo primero fue crear un virtualhost para una intranet que albergaría un
wordpress.</p>

<figure class='code'><figcaption><span>/etc/apache2/sites-enabled/wordpress</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='apacheconf'><span class='line'><span class="err">lazaro@leviatan:~/octopress$</span> <span class="nb">cat</span> <span class="sx">/etc/apache2/sites-enabled/wordpress</span>
</span><span class='line'><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
</span><span class='line'>        <span class="nb">ServerAdmin</span> lazaro@localhost
</span><span class='line'>        <span class="nb">ServerName</span> intranet.hcg.sld.cu
</span><span class='line'>
</span><span class='line'>        <span class="nb">DocumentRoot</span> <span class="sx">/usr/share/wordpress/</span>
</span><span class='line'>
</span><span class='line'>        <span class="nt">&lt;Directory</span> <span class="s">/usr/share/wordpress/</span><span class="nt">&gt;</span>
</span><span class='line'>                <span class="nb">Options</span> FollowSymLinks MultiViews
</span><span class='line'>                <span class="nb">AllowOverride</span> <span class="k">All</span>
</span><span class='line'>                <span class="nb">Order</span> allow,deny
</span><span class='line'>                <span class="nb">allow</span> from <span class="k">all</span>
</span><span class='line'>        <span class="nt">&lt;/Directory&gt;</span>
</span><span class='line'>
</span><span class='line'>        <span class="nb">ErrorLog</span> ${APACHE_LOG_DIR}/error.log
</span><span class='line'>
</span><span class='line'>        <span class="c"># Possible values include: debug, info, notice, warn, error, crit,</span>
</span><span class='line'>        <span class="c"># alert, emerg.</span>
</span><span class='line'>        <span class="nb">LogLevel</span> <span class="k">warn</span>
</span><span class='line'>
</span><span class='line'>        <span class="nb">CustomLog</span> ${APACHE_LOG_DIR}/access.log combined
</span><span class='line'><span class="nt">&lt;/VirtualHost&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Declaramos el virtualhost en el DNS. En este caso, es hacer un puntero a la
maquina donde está el wordpress. Como uso dnsmasq, basta con agregarlo al
virtuahost.</p>

<figure class='code'><figcaption><span>dnsmasq</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">root@blackjack:~#</span> cat /etc/hosts<span class="p">|</span>grep intranet
</span><span class='line'><span class="go">10.1.1.14   intranet.hcg.sld.cu</span>
</span><span class='line'>
</span><span class='line'><span class="gp">root@blackjack:~#</span> /etc/init.d/dnsmasq restart
</span><span class='line'><span class="go">Restarting DNS forwarder and DHCP server: dnsmasq.</span>
</span></code></pre></td></tr></table></div></figure>


<p>E instalar wordpress:</p>

<figure class='code'><figcaption><span>aptitude</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">root@leviatan:~#</span> aptitude install wordpress
</span></code></pre></td></tr></table></div></figure>


<p>Como si fuese poca la carga de mi servidor SQL, resulta que cada sitio de
wordpress, es simplemente una configuración y una base de datos.</p>

<p>Basta copiar la configuración de ejemplo y bautizarla en /etc/wordpress con el
prefijo <strong>config-</strong> seguido del nombre del virtualhost.</p>

<figure class='code'><figcaption><span>cp</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">lazaro@leviatan:~/octopress$</span>  cp /usr/share/wordpress/wp-config-sample.php /etc/wordpress/config-intranet.hcg.sld.cu.php
</span></code></pre></td></tr></table></div></figure>


<p>Dentro del fichero, la configuración, es un bien comentado script de PHP, que
figura los datos para una conexión a la base de datos. Obviemos los comentarios
para ahorrar espacio. El fichero me quedó así.</p>

<figure class='code'><figcaption><span>/etc/wordpress/config-intranet.hcg.sld.cu.php</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;?</span><span class="nx">php</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;wordpress&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_USER&#39;</span><span class="p">,</span> <span class="s1">&#39;wordpress&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_PASSWORD&#39;</span><span class="p">,</span> <span class="s1">&#39;secretisimo&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_HOST&#39;</span><span class="p">,</span> <span class="s1">&#39;localhost&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_CHARSET&#39;</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;DB_COLLATE&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;AUTH_KEY&#39;</span><span class="p">,</span>         <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;SECURE_AUTH_KEY&#39;</span><span class="p">,</span>  <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;LOGGED_IN_KEY&#39;</span><span class="p">,</span>    <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;NONCE_KEY&#39;</span><span class="p">,</span>        <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;AUTH_SALT&#39;</span><span class="p">,</span>        <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;SECURE_AUTH_SALT&#39;</span><span class="p">,</span> <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;LOGGED_IN_SALT&#39;</span><span class="p">,</span>   <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;NONCE_SALT&#39;</span><span class="p">,</span>       <span class="s1">&#39;put your unique phrase here&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nv">$table_prefix</span>  <span class="o">=</span> <span class="s1">&#39;wp_&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;WPLANG&#39;</span><span class="p">,</span> <span class="s1">&#39;es_ES&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;WP_DEBUG&#39;</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">defined</span><span class="p">(</span><span class="s1">&#39;ABSPATH&#39;</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'>        <span class="nb">define</span><span class="p">(</span><span class="s1">&#39;ABSPATH&#39;</span><span class="p">,</span> <span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">require_once</span><span class="p">(</span><span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">&#39;wp-settings.php&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="s1">&#39;WP_ALLOW_REPAIR&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Como ven, hay un &ldquo;algo&rdquo;; no se si variable. Bajo el nombre DB_NAME, declaramos
el nombre de la base de datos y así sucesivamente lo obvio hasta DB_HOST.</p>

<p>De ahí pa alante, no tocamos más nada.</p>

<p>Ya estamos listo para crear la base da datos. La rutina clásica: Haremos un
usuario con el mismo nombre de la base y le daremos todos los permisos.</p>

<figure class='code'><figcaption><span>$mysql</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">lazaro@leviatan:~/octopress$</span> mysql -u root -p
</span><span class='line'><span class="go">Enter password:</span>
</span><span class='line'><span class="go">Welcome to the MySQL monitor.  Commands end with ; or \g.</span>
</span><span class='line'><span class="go">Your MySQL connection id is 42</span>
</span><span class='line'><span class="go">Server version: 5.5.30-1.1 (Debian)</span>
</span><span class='line'>
</span><span class='line'><span class="go">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</span>
</span><span class='line'>
</span><span class='line'><span class="go">Oracle is a registered trademark of Oracle Corporation and/or its</span>
</span><span class='line'><span class="go">affiliates. Other names may be trademarks of their respective</span>
</span><span class='line'><span class="go">owners.</span>
</span><span class='line'>
</span><span class='line'><span class="go">Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span>
</span><span class='line'>
</span><span class='line'><span class="go">mysql&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">Y ahora creamos la base de datos y el usuario con estas sentencias</span>
</span><span class='line'><span class="go">NOTA: en nuestro ejemplo tanto la base de datos como el usuario son wordpress, reemplazar PASSWORD_DB por el password que deseen asignarle a la base de datos.</span>
</span><span class='line'>
</span><span class='line'><span class="go">mysql&gt; CREATE DATABASE wordpress;</span>
</span><span class='line'><span class="go">Query OK, 1 row affected (0.00 sec)</span>
</span><span class='line'>
</span><span class='line'><span class="go">mysql&gt; GRANT ALL ON wordpress.* TO wordpress@localhost IDENTIFIED BY &#39;secretisimo&#39;;</span>
</span><span class='line'><span class="go">Query OK, 0 rows affected (0.00 sec)</span>
</span><span class='line'>
</span><span class='line'><span class="go">mysql&gt; FLUSH PRIVILEGES;</span>
</span><span class='line'><span class="go">Query OK, 0 rows affected (0.00 sec)</span>
</span><span class='line'>
</span><span class='line'><span class="go">mysql&gt; \q</span>
</span><span class='line'><span class="go">Bye</span>
</span></code></pre></td></tr></table></div></figure>


<p>COMPLETO! Reinicia apache, reinicia dnsmasq y apunta un navegador al nombre del
servidor para ver que pasa.</p>

<p><a href="http://intranet.hcg.sld.cu">http://intranet.hcg.sld.cu</a></p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.09 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/18/lxc-en-salud/">lxc en salud</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-04-18T21:14:10-04:00'><span class='date'>18/04/2014</span> <span class='time'>9:14 pm</span></time>
        
           | <a href="/blog/2014/04/18/lxc-en-salud/#disqus_thread"
             data-disqus-identifier="http://uranio-235.github.io/blog/2014/04/18/lxc-en-salud/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>¡Me han asignado mi segundo servidor en el calixto! Un cliente ligero con 2
gigas de RAM, un buen micro y un disco duro de un tera. La fuente funciona de
milagro y está sujeta al chásis mediante bridas.</p>

<p>Le he instalado archlinux (para variar) a partir del que tengo en la laptop.
Aquí pienso instalar el servidor de correo, un servidor web para una serie de
aplicaciones y un pequeño servidor ftp para disponer instaladores y
actualización de antivirus. No soporta virtualización (¿y con que se sienta la
cucaracha si lo soportara?). Por tanto, usaremos archlinux como hypervisor de
lxc.</p>

<p>Por suerte, en infomed; hay un excelente repo de debian</p>

<p>Para crear contenedores de debian en arch, necesitaremos <strong>debootstrap</strong>, que
por suerte, viene en el repo de arch.</p>

<p>Este archlinux está instalado sobre BTRfs con el COW activado. Me imagino que
crear snapshots de los contenedores sea mucho más óptimo.</p>

<p>Creamos entonces el contenedor, usando el repo de infomed como mirror</p>

<figure class='code'><figcaption><span>&#8220;lxc-create&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">lxc-create -n debian -t \</span>
</span><span class='line'><span class="go">/usr/share/lxc/templates/lxc-debian -- -r jessie \</span>
</span><span class='line'><span class="go">--mirror=http://ftp.sld.cu/debian \</span>
</span><span class='line'><span class="go">--security-mirror=http://ftp.sld.cu/debian</span>
</span></code></pre></td></tr></table></div></figure>


<p>O sea, crea un contenedor, llamado (-n) debian, del release (-r) jessie y usa
como repo (&ndash;mirror y &ndash;security) al de infomed.</p>

<p>Pasé toda la noche resando para que no se fuera a caer la conexión, ya que la
operación create de LXC falla de nada. Por suerte todo salió de acorde al plan.</p>

<figure class='code'><figcaption><span>&#8220;listo debian&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# du -hs /var/lib/lxc/</span>
</span><span class='line'><span class="go">248M /var/lib/lxc/</span>
</span></code></pre></td></tr></table></div></figure>


<p>La idea es, crear un snapshot del básico y restaurarlo con un nuevo nombre.</p>

<p>Pero este está demasiado básico. DESNÚ más bien. Partiremos de ese contenedor
como base para crear nuevos contenedores mediante snapshots. Así que a este le
instalaremos una selección básica de software.
Arrancamos el contenedor:</p>

<figure class='code'><figcaption><span>&#8220;lxc-start&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# lxc-start -n debian</span>
</span></code></pre></td></tr></table></div></figure>


<p>y enclavamos (attach) la consola, o sea, básicamente, entramos al container</p>

<figure class='code'><figcaption><span>&#8220;enclavando la consola&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# lxc-console -n debian</span>
</span><span class='line'>
</span><span class='line'><span class="go">Connected to tty 1</span>
</span><span class='line'><span class="go">       Type &lt;Ctrl+a q&gt; to exit the console, &lt;Ctrl+a Ctrl+a&gt; to enter Ctrl+a itself</span>
</span><span class='line'>
</span><span class='line'><span class="go">Debian GNU/Linux 8 debian tty1</span>
</span><span class='line'>
</span><span class='line'><span class="go">debian login: </span>
</span></code></pre></td></tr></table></div></figure>


<p>Según la plantilla de archlinux, el password por defecto del container es
&ldquo;root&rdquo;. Entramos al mismo y le cambiamos el password. Apto seguido, instalar el
software.</p>

<p>En mi opinión un container básico, requiere al menos:</p>

<pre><code>mc, tmux, vim, aptitude, iputils-ping
</code></pre>

<p>Pero además, <em>puede que quizás te guste</em> añadirle:</p>

<pre><code>manpages, resolvconf, telnet, iptables
</code></pre>

<p>Terminada la faena, damos logout y luego presionamos la combinación &ldquo;Ctrl+a q&rdquo;.
O sea, &ldquo;control A&rdquo; primero, luego suelta ambas y presiona &ldquo;q&rdquo;. Con eso
desenclavas (detach) la consola del container (que sigue corriendo).</p>

<p>Bello verdad?! Linux es un sistema multitareas y multiusuario.</p>

<p>Haremos un snapshot de <strong>debian</strong>, esto dará lugar a <strong>snap0</strong>. O sea primer,
snapshot del container &ldquo;debian&rdquo;, lo podrás ver en <em>/var/lib/lxc/debian/snaps</em>.
Ah! Para hacer un snapshot, <strong>paramos</strong> el container primero.</p>

<figure class='code'><figcaption><span>&#8220;lxc-snapshot&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# lxc-stop -n debian </span>
</span><span class='line'><span class="go">[root@leviatan ~]# lxc-snapshot -n debian </span>
</span></code></pre></td></tr></table></div></figure>


<p>y lo restauramos con el nombre del nuevo container</p>

<figure class='code'><figcaption><span>&#8220;lxc-snapshot&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# lxc-snapshot -n debian -r snap0 -N mail</span>
</span><span class='line'><span class="go">[root@leviatan ~]# lxc-snapshot -n debian -r snap0 -N web</span>
</span><span class='line'><span class="go">[root@leviatan ~]# lxc-snapshot -n debian -r snap0 -N ftp</span>
</span><span class='line'><span class="go">[root@leviatan ~]# lxc-ls -f</span>
</span><span class='line'><span class="go">NAME   STATE   AUTOSTART GROUPS IPV4 IPV6</span>
</span><span class='line'><span class="go">debian STOPPED 0         -      -    -</span>
</span><span class='line'><span class="go">mail   STOPPED 0         -      -    -</span>
</span><span class='line'><span class="go">ftp    STOPPED 0         -      -    -</span>
</span><span class='line'><span class="go">web    STOPPED 0         -      -    -</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ya tenemos las tres máquinas. Por lo tanto, NO vale la pena conservar el
snapshot ni la máquina base (¿o sí?). Yo opté por borrar ambos.</p>

<figure class='code'><figcaption><span>&#8220;limpiando&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go">[root@leviatan ~]# lxc-snapshot -n debian -d snap0</span>
</span><span class='line'><span class="go">[root@leviatan ~]# lxc-destroy -n debian</span>
</span></code></pre></td></tr></table></div></figure>


<p>No vale pena tener ssh corriendo en los contenedores. Simplemente le haces ssh
al servidor y attach al contenedor. Esto lo hace incluso hasta más seguro.</p>

<p>La mecánica de trabajo en este esquema, es prácticamente la misma que vimos
ahora. Arrancar el container y enclavar la consola.</p>

<p>¿Notaste que puse a iptables como paquete opcional? Pues el iptables del
hypervisor, o sea, del arch de afuera, controla todo el tráfico.</p>

<p>Como no usamos red en bridge, todos los container tiran por la misma ip. En el
servido web, se usa el puerto 80 y 443, en el de correo el 25 y 110; <strong>pero
todos en la misma ip</strong>. Por esta razón, no corro ssh en los contenedores;
diría que el puerto 22 ya se encuentra en eso.</p>

<p>Aquí les dejo entonces la configuración de este container, con red del tipo
&ldquo;none&rdquo;</p>

<figure class='code'><figcaption><span>&#8220;config de&#8221;</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="go"> [root@leviatan ~]# cat /var/lib/lxc/debian/config |grep -v &#39;#&#39;</span>
</span><span class='line'><span class="go"> lxc.include = /usr/share/lxc/config/debian.common.conf</span>
</span><span class='line'><span class="go"> lxc.tty = 4</span>
</span><span class='line'><span class="go"> lxc.arch = amd64</span>
</span><span class='line'><span class="go"> lxc.network.type = none</span>
</span><span class='line'><span class="go"> lxc.rootfs = /var/lib/lxc/debian/rootfs</span>
</span><span class='line'><span class="go"> lxc.rootfs.backend = dir</span>
</span><span class='line'><span class="go"> lxc.utsname = debian</span>
</span></code></pre></td></tr></table></div></figure>


<p>Por otra parte, cosas como el mysql, que el servidor de correo necesita
encuestarlo, simplemente, podrías ponerlo a escuchar por la 127.0.0.1 y así el
container del servidor sql, escucha por la 127 y los demás container (incluso el
hypervisor) se conectan al localhost donde está el mysql. O sea, la 127.0.0.1
sería como la red interna de todos los container. ¿Es seguro verdad?</p>

<p>Podemos confiarle ahora, a la frescura y robusteza de archlinux, la estabilidad
de debian.</p>
</div>
  
  


<p>Si este art&iacute;culo te result&oacute; interesante, considere donar 0.07 BTC: <a href="/images/direccion.png">1Kg4gu3e7u8HUw8bj5NbBciRg6Y56kuFCU</a> </p>

    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/17">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/15">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>

	<h1>Lo m&aacute;s reciente</h1>

	<ul id="recent_posts">
		
		<li class="post">
			<a href="/blog/2017/02/22/bind-personal/">bind personal</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/02/05/a-las-puertas-del-3g/">a las puertas del 3g</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/02/05/dns-con-vistas/">dns con vistas</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/02/01/ipfw-simple-y-consiso/">ipfw simple y conciso</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/28/freebsd-11/">mis crónicas con freebsd</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/21/palito/">animación del palito</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/20/datatables-espanol/">DataTables en español</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/09/tendencias-tecnologicas/">tendencias tecnológicas</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/09/flasheando-modem-al-s4/">flasheando modem al S4</a>
		</li>
		
		<li class="post">
			<a href="/blog/2017/01/02/rails-assets/">rails-assets</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/12/29/xgproyect/">xgproyect</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/12/27/cambiar-mac-a-un-nano/">cambiar mac a un nano</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/12/19/phpmyadmin-multiples-servidores/">phpmyadmin múltiples servidores</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/12/19/iptables-y-ftp/">iptables y ftp</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/12/09/rails-en-alpine/">rails en alpine</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/11/24/squid3-bloquear-user-agent/">squid3 bloquear user-agent</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/11/22/redimensionar-lvm/">redimensionar lvm</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/11/20/sysinfo-en-el-motd/">sysinfo en el motd</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/11/14/openvpn-user-plus-pass/">openvpn user+pass</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/el-domain-pop/">recolección DomainPOP</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/domainpop-con-postfix/">domainpop con postfix</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/tunel-6in4/">túnel 6in4</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/cortafuegos-ipv6-sencillo/">cortafuegos ipv6 sencillo</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/poniendo-direcciones-ipv6/">las reglas del juego ipv6</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/22/ipv6/">la resolución 185/2016</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/10/04/dirver-broadcom/">driver broadcom</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/09/22/audifonos-blutu/">audífonos blutú</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/09/16/dispatcher-script/">dispatcher script</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/08/16/password-de-windows/">password de windows</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/08/15/repositorio-de-iso-en-xen/">Local ISO en xen</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/07/31/kiwix-como-servicio/">kiwix como servicio</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/07/17/hibernar-en-archlinux/">hibernar en archlinux</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/07/17/rsync-basico/">rsync básico</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/06/20/correos-del-cron/">correos del cron</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/06/18/dkim-y-spf-en-postfix/">dkim y spf en postfix</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/06/06/desacelerar-mouse/">desacelerar mouse</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/05/12/deshabilitar-historial-de-bash/">deshabilitar historial de bash</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/04/29/reparar-archivos-de-innodb/">reparar archivos de innodb</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/04/01/wpa2-con-freeradius/">WPA2 con freeradius</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/03/14/misterio-con-ethernet-foxconn/">misterio con ethernet foxconn</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/03/07/cargar-rvm/">cargar rvm</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/02/22/data-confirm-en-un-boton/">data confirm en un boton</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/02/20/hooks-de-pacman/">los hooks de pacman</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/02/01/arch-compartir-paquetes/">arch compartir paquetes</a>
		</li>
		
		<li class="post">
			<a href="/blog/2016/01/25/hostname-arbitrario-en-bind9/">bind9, registro arbitratio</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/12/14/servidor-jabber-con-prosody/">servidor jabber con prosody</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/29/mc-demora-en-abrir/">mc demora en abrir</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/23/desmume-ultralento/">desmume ultralento</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/22/certificado-autofirmado/">certificado autofirmado</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/12/rc-dot-local-en-systemd/">rc.local en systemd</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/03/las-mujeres-gordas/">las mujeres gordas</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/11/03/tls-y-ssl-en-postfix/">tls y ssl en postfix</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/10/20/compartir-la-wifi/">compartir la wifi</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/10/18/systemd-timesyncd/">systemd-timesyncd</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/10/15/repo-de-fdroid/">repo de fdroid</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/10/08/prawn-pdf-con-ruby/">prawn, pdf con ruby</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/10/05/assets-por-controlador/">assets por controlador</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/09/17/dhcp-por-grupos/">dhcp por grupos</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/09/10/plymouth-boot-screen/">plymouth boot screen</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/09/07/git-clone-rapido/">git clone rápido</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/09/07/archlinux-dos-kernel/">archlinux con dos kernel</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/09/01/squid-transparente/">squid transparente</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/08/28/compute-remote-uptime/">compute remote uptime</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/07/24/transliteracion-del-coran/">transliteración del corán</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/07/12/date-select-en-espanol/">date_select en español</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/07/11/openvas-en-archlinux/">OpenVAS en Archlinux</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/07/05/anadir-verbo-a-un-scaffold/">añadir verbo a un scaffold</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/07/05/asset-pipeline-en-production/">asset pipeline en production</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/30/bootstrap-en-rails-4/">bootstrap en rails 4</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/21/se-dice-dios-no-ala/">se dice DIOS, no alá</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/12/systemd-automount/">systemd automount</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/07/openvpn-en-arch/">OpenVPN en Arch</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/03/transando-a-ext4/">transando a ext4</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/06/01/pacman-bajo-el-microscopio/">pacman bajo el microscopio</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/05/28/cambiar-user-agent-en-squid/">cambiar user agent con squid</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/05/26/nic-bonding/">NIC bonding</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/05/23/ltsp-en-debian8-y-salud/">ltsp en debian8 y salud</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/02/21/sasl-homeclub-only/">SASL homeclub only</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/02/19/delay-pools-de-squid/">delay pools de squid</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/02/12/rails-con-mongodb/">rails con mongodb</a>
		</li>
		
		<li class="post">
			<a href="/blog/2015/02/06/zentyal/">Zentyal</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/12/02/welcome-aboard/">welcome aboard</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/10/28/proxy-automatico/">proxy automático</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/09/24/verdial-y-el-imagis/">la pena de verdial</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/09/05/palos-de-wordpress/">palos de wordpress</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/08/25/el-server-de-correo/">el servidor de correo</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/08/25/mas-de-ocs/">más de OCS</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/08/15/subdesarrollo/">subdesarrollo</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/08/11/ocs-inventory/">ocs-inventory</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/07/08/select-en-bootstrap/">select en bootstrap</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/07/05/empirico/">empíricos</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/06/10/autenticador-sql-en-el-proxy/">autenticador SQL en el proxy</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/06/09/postfix-entrando-en-el-baile/">postfix entrando en el baile</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/06/09/dovecot-entra-en-el-baile/">dovecot entra en el baile</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/05/02/wordpress-para-todos/">wordpress para todos</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/04/18/lxc-en-salud/">lxc en salud</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/04/06/squid-en-infomed/">el toten de proxies</a>
		</li>
		
		<li class="post">
			<a href="/blog/2014/04/04/en-la-cumbre-del-vedado/">el &#8220;calisto&#8221; garcía</a>
		</li>
		
	</ul>
	
</section>





  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - låzaro -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'uranio-235';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-68987437-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</body>
</html>
